;try {
/* module-key = 'com.atlassian.confluence.confluence-editor-hide-tools:confluence-editor-hide-tools-resources', location = '/js/confluence-editor-hide-tools.js' */
(function(g){if(g.browser.msie){return}AJS.Rte.BootstrapManager.addTinyMcePluginInit(function(y){y.plugins+=",dfe"});var s=function(y){return{"-moz-transform":y,"-webkit-transform":y,transform:y}};var p=function(z){var y=z.css("transform")||z.css("-webkit-transform")||z.css("-moz-transform");if(y=="none"){return 0}return parseInt((y.match(/^matrix\(.*?(-?[\d.]+)\)$/)||[])[1])||0};var u=function(y){return"translateY("+y+"px)"};var l=function(){return"transitionend webkitTransitionEnd MSTransitionEnd"};var n=function(){if(window.fullScreen){return window.fullScreen}return(window.innerWidth==screen.width&&window.innerHeight==screen.height)};var w=false;var t=true;var r="dfe.";var h=0;var m=0;var b=null;var x=null;var f=0;var a=null;var j=+new Date;var q=function(y,z){z=z||{};z.uid=j;AJS.trigger("analyticsEvent",{name:r+y,data:z})};var i=null;var e=false;var o=0;var k=null;var d=null;var c=null;g(function(){k="confluence."+AJS.params.remoteUser+".dfe.";d=k+"totalEdits";c=k+"hasUsed";if(window.localStorage){o=window.localStorage.getItem(d)||0;e=!!window.localStorage.getItem(c)}});var v=function(){f+=(+new Date-x)};g(window).bind("beforeunload",function(){if(!w){return}q("hoveredOverToolbarsCount",{header:h,footer:m});var y=(+new Date-b-f);q("editorInteractionTimeSeconds",{normal:Math.round(y/1000),dfe:Math.round(f/1000)})});tinymce.create("tinymce.plugins.DFEPlugin",{active:false,transitioning:false,hangOnScreenHeightHeader:t?0:8,hangOnScreenHeightFooter:8,hideToolsButton:null,editorToolbar:null,savebarContainer:null,wysiwyg:null,iframe:null,activatedDropdownContext:false,originalEditorToolbarHeight:0,originalEditorToolbarTranslateY:0,editorToolbarCurrentHeight:0,editorToolbarCurrentTranslateY:0,init:function(y){y.onInit.add(_.bind(function(H){var J=g("body");var X=!!g(H.formElement).closest("#comments-section").length;var E=this.editorToolbar=g("#toolbar");var R=this.savebarContainer=g("#savebar-container");var W=this.hangOnScreenHeightHeader;var P=this.hangOnScreenHeightFooter;var L=[E,R];this.wysiwyg=g("#wysiwyg");this.iframe=this.wysiwyg.find("iframe");this.editorMessages=g("#editor-messages");if(X){return}b=+new Date;g(function(){o++;window.localStorage&&window.localStorage.setItem(d,o)});w=true;g("#content + .clear").remove();g(window).scroll(function(Y){Y.preventDefault()});J.toggleClass("no-tools-pin-toolbar",t);var T=g("<ul />",{"class":"aui-buttons"});var U=g("<li />",{"class":"toolbar-item aui-button",id:"rte-button-toolbartoggle","data-tooltip":"Hide Tools (Ctrl+Shift+F)"});var V=g("<a />",{href:"#"});var S=g("<span />",{"class":"icon icon-toolbartoggle",text:"Hide Tools (Ctrl+Shift+F)"});S.prependTo(V);V.appendTo(U);U.appendTo(T);T.prependTo("#rte-toolbar .aui-toolbar2-secondary");this.hideToolsButton=T;J.toggleClass("no-transition",!this.useTransition());setTimeout(function(Y){Y.contents().find("body").addClass("no-tools-capable")},500,this.iframe);this.hideToolsButton.click(_.bind(this.toggle,this));this.bindKeyboardShortcuts();var M=_.bind(function(aa){if(i){setTimeout(function(){i.view.popup.refresh();i.view.$el.find(".arrow svg").slice(1).remove()},100)}if(!this.active){return}var Z=u(this.editorToolbarCurrentTranslateY-(E.height()-this.editorToolbarCurrentHeight));var Y=u(R.height()-P);N({header:Z,footer:Y})},this);AJS.bind("messageClose",M);var B=[];var A=function(Y){return/\((?:max|min)-(?:width|height):\s*/.test(Y)};window.matchMedia&&_.each(document.styleSheets,function(Y){try{if(Y.media&&A(Y.media.mediaText)){B.push(Y.media.mediaText)}_.each(Y.cssRules,function(aa){if(aa instanceof CSSMediaRule){if(A(aa.media.mediaText)){B.push(aa.media.mediaText)}}})}catch(Z){}});_.each(B,function(Z){var Y=window.matchMedia(Z);Y.addListener(M)});var O=_.bind(this.showHelpTips,this);g(setTimeout(O,3000));g(window).resize(_.debounce(O,100));function I(){J.toggleClass("no-tools-probably-full-screen",n())}g(window).resize(_.debounce(I,100));I();g(document).on("hideLayer",function(Z,Y,aa){if(Y!="inlineDialog"){return}setTimeout(function(){a=null},5000)});g("#rte-button-preview").click(this.hideHelpTips);if(!this.useTransition()){return}var Q=g("<div class='editor-toolbar-transition-cover' />");!t&&Q.clone().addClass("header").appendTo("body");Q.addClass("footer").appendTo("body");var F;var N=_.bind(function(Y){var Z="no-tools-dont-animate";if(t&&this.active){setTimeout(_.bind(function(){var aa=this.originalEditorToolbarTranslateY+this.editorToolbar.height()-this.originalEditorToolbarHeight;this.wysiwyg.css(s(u(aa)));this.adjustIframeHeight()},this),0);return}J.addClass(Z);E.css(s(Y.header));R.css(s(Y.footer));clearTimeout(F);F=setTimeout(function(){J.removeClass(Z)},1000)},this);var D=null;g(window).resize(_.bind(function(){if(!this.active){return}var Y=g(window).width();if(Y!=D&&D<1024){M()}D=Y},this));this.originalEditorToolbarTranslateY=p(E);this.savebarContainerOriginalTranslateY=p(R);var K=false;var G=false;g(document).on("mouseenter",".tipsy",function(){K=true}).on("mouseleave",".tipsy",function(){setTimeout(function(){if(K){g.each(L,function(){g(this).trigger("mouseleave")})}K=false},50)});g.each(L,_.bind(function(Z,aa){var ac=aa[0]==R[0];if(t&&!ac){return}var ab=null;var ad="no-tools-toolbars-visible";var Y=null;var ae=aa.find(".extended-hit-zone");if(!ae.length){ae=g("<div class='extended-hit-zone' />").appendTo(aa)}aa.on("mouseenter",_.bind(function(){if(!this.active||this.transitioning){return}if(ac){var ag=this.iframe;var af=ag.contents().find("body").prop("scrollWidth")>ag.width();ae.toggle(!af);m++}else{h++}K=false;G=true;J.addClass(ad);var ai=ac?this.savebarContainerOriginalTranslateY:this.originalEditorToolbarTranslateY-W+E.height()-(E.height()-this.originalEditorToolbarHeight);var ah=u(ai);aa.css(s(ah))},this));aa.on("mouseleave",_.bind(function(){clearTimeout(Y);if(!this.active||this.transitioning){return}G=false;this.hideStragglers();var ag=ac?this.savebarContainerOriginalTranslateY+R.height()-P:this.originalEditorToolbarTranslateY-(E.height()-this.originalEditorToolbarHeight);var af=u(ag);Y=setTimeout(function(){if(K){return}aa.css(s(af));J.removeClass(ad)},50)},this))},this));g(document).on("createContextToolbarRow.Toolbar resize.resizeplugin rte.heartbeat",_.bind(function(aa,Y){if(!this.active){M();return}if(G){return}if(Y&&Y.id=="searchreplace"){this.deactivate();return}this.updateToolbarsDimensions();var Z=u(this.editorToolbarCurrentTranslateY);N({header:Z,footer:null})},this));var z=AJS.Meta.get("page-id")!="0";if(z){var C=_.bind(this.setActiveStateFromLastSession,this);g(function(){setTimeout(C,500)})}},this))},useTransition:(function(){var y=null;return function(){if(y===null){var z=["","webkit","moz"];if(g.browser.msie){return false}var A=function(B){return(B?"-"+B+"-":"")};y=!!g.grep(z,function(B){return document.body.style[A(B)+"transition"]!==undefined}).length}return y}})(),toggle:function(){this.active=!this.active;this[this.active?"activate":"deactivate"].call(this)},deactivate:function(){this.active=false;this.update();q("deactivate")},activate:function(){this.active=true;this.update();var y={viewportSize:window.innerWidth+"x"+window.innerHeight,helpTipDiscovered:a};q("activate",y);window.localStorage.setItem(c,true);this.hideHelpTips()},update:function(){var D=function(Z,Y){Y===undefined&&(Y="auto");return F?Z:Y};var I=g("body");var F=this.active;var O=F?"hidetools.toolbar.item.deactivate":"hidetools.toolbar.item.activate";var X=AJS.I18n.getText(O);g("#rte-button-toolbartoggle").toggleClass("active",F).attr({title:X,"data-tooltip":X,"original-title":X});if(F){x=+new Date}else{v()}this.hideStragglers();if(!this.useTransition()){I.toggleClass("no-tools",F);g.browser.msie&&g(window).resize();return}this.transitioning=true;var A=this.wysiwyg;var N=g("#editor-precursor");var R=g("#header");var H=g("#header-precursor");var E=this.editorMessages;var B=this.editorToolbar;var V=this.savebarContainer;var G=V.height();var Q=R.height();var J=H.height();var z=g("form.editor");var K=N.height()+Q+B.height()+J;var W=this.hangOnScreenHeightHeader;var T=this.hangOnScreenHeightFooter;this.originalEditorToolbarHeight=B.height();F&&I.css("overflow-y","hidden");this.adjustIframeHeight();!F&&E.insertAfter(N.find("#content-title-div"));I.removeClass("no-tools-toolbars-visible no-tools-animate no-tools-animate-end");var U=A.add(R).add(H).add(B).add(N);F&&U.css({top:function(){return g(this).offset().top}});I.addClass("no-tools");var S=AJS.dropDown.current||g(".aui-property-panel-parent");N.css({height:D(N.height()),overflow:D("hidden")});if(t){K-=B.height()}var L=D(u(W-K),"none");var y=D(u(G-T),"none");if(S){var M=u((-K+(W*2)+(t?0:2))*(this.activatedDropdownContext?-1:1));var C="none";var P=this.activatedDropdownContext?D(C,M):D(M,C)}this.originalEditorToolbarTranslateY=W-K;this.savebarContainerOriginalTranslateY=p(V);!this.active&&I.addClass("no-tools-show-tools");if(!t){this.iframe.contents().find("body").toggleClass("no-tools-enabled",F)}setTimeout(function(Y){var Z=l();z.off(Z).on(Z,function(aa){if(aa.target!=N[0]){return}if(F){g("#editor-messages").appendTo(I);setTimeout(function(){I.addClass("no-tools-animate-end")},0)}else{A.css("height","100%");I.removeClass("no-tools no-tools-animate").css("overflow-y","auto")}Y.transitioning=false;document.activeElement.tagName.toLowerCase()!="input"&&AJS.Rte.getEditor().focus();Y.updateToolbarsDimensions()});I.addClass("no-tools-animate");U.css(s(L));V.css(s(y));if(S){(S instanceof jQuery?S:S.$.parent().add("body > svg")).css(s(P))}},0,this);this.storeActiveStateForNextSession()},updateToolbarsDimensions:function(){this.editorToolbarCurrentHeight=this.editorToolbar.height();this.editorToolbarCurrentTranslateY=this.originalEditorToolbarTranslateY-(this.editorToolbarCurrentHeight-this.originalEditorToolbarHeight)},hideStragglers:function(){g(".aui-dropdown, #table-picker-backdrop").each(function(){if(g(this).hasClass("hidden")){return true}var y=this.id=="table-picker-backdrop"?g(this):g(this).closest(".toolbar-item");y.click()})},adjustIframeHeight:function(){this.iframe.css("paddingBottom",this.active?this.editorToolbar.height()+this.hangOnScreenHeightFooter+1:0)},bindKeyboardShortcuts:(function(){var y=false;var C=false;var z=null;var A=function(){clearTimeout(z);C=true};var B=function(){clearTimeout(z);z=setTimeout(function(){C=false},500)};return function(){if(y){return}y=true;var E=_.bind(function(F){if(!this.transitioning&&F.ctrlKey&&F.shiftKey&&F.keyCode=="F".charCodeAt(0)){F.preventDefault();this.toggle();q("keyboardShortcutUsed",{shortcut:"toggle"})}},this);var D=AJS.Rte.getEditor();D.onKeyDown.add(_.bind(function(F,G){E(G)},this));g(document).on("keydown",E);D.onKeyUp.add(_.bind(function(F,G){if(!this.active||C||G.keyCode!=27){return}this.deactivate();q("keyboardShortcutUsed",{shortcut:"escape"})},this));AJS.bind("show.dialog",A);g(document).bind("showLayer",_.bind(function(G,F){if(F=="dropdown"){this.activatedDropdownContext=this.active;A()}},this));AJS.bind("hide.dialog",B);g(document).bind("hideLayer",function(G,F){if(F=="dropdown"){this.activatedDropdownContext=false;B()}})}})(),hideHelpTips:function(){if(!i){return}i.view.$el.remove();i=null},showHelpTips:(function(){var y={};var A="dfe.betteruseofscreen";var z="dfe.neverused";return function(){var B=parseInt(AJS.Meta.get("build-number"),10);var C=B>4370;if(!AJS.HelpTip||!C){return}AJS.HelpTip.Manager.loaded.done(_.bind(function(){var J=n();if(this.active||g(".aui-help-tip").length||i!=null){if(!J&&i!=null&&i.attributes.fullScreen){this.hideHelpTips()}return}var L=AJS.HelpTip.Manager.dismissedTipIds;var M=function(N){return g.inArray(N,L)>-1};var F=50;var D=g(window).height();var I=(D-this.wysiwyg.height())/D;var G={id:null,body:null,anchor:this.hideToolsButton};if(!e&&o>F&&!M(z)&&!M(A)){G.body="\u003cstrong\u003eGet in the zone.\u003c/strong\u003e Hide the toolbar and focus on your content with distraction-free editing.";G.id=a=z}else{if(I>0.3&&!M(A)){G.body="\u003cstrong\u003eWant more room?\u003c/strong\u003e Hide the toolbar and focus on your content with distraction-free editing.";G.id=A;a="smalleditingspace"}else{if(J){G.body="\u003cstrong\u003eLooks like you\'re in full-screen mode\u003c/strong\u003e. Get even more editing space by hiding the editor toolbar.";G.id=A;G.fullScreen=true;a="fullscreen"}}}if(!G.id){this.hideHelpTips();return}var K=new AJS.HelpTip(G);if(window.localStorage){var H=k+"helptip."+G.id+".showncount";var E=+window.localStorage.getItem(H)||0;if(!y.hasOwnProperty(G.id)){E++;window.localStorage.setItem(H,E);y[G.id]=true}if(E>4){K.dismiss();return}}K.show();i=K},this))}})(),setActiveStateFromLastSession:function(){var y=window.localStorage&&window.localStorage.getItem(k+"activeState");if(y==="true"){this.activate()}},storeActiveStateForNextSession:function(){window.localStorage&&window.localStorage.setItem(k+"activeState",this.active)},getInfo:function(){return{longname:"Distraction Free Editor Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("dfe",tinymce.plugins.DFEPlugin)})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
